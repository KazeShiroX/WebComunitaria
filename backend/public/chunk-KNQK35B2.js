import{Hb as h,Ib as N,J as f,Lb as v,N as d,S as b,a as n,b as s,da as m,l as p,p as o,x as g}from"./chunk-WVB2344H.js";var C=class l{http=b(N);apiConfig=b(v);baseUrl=`${this.apiConfig.baseUrl}/noticias`;categorias=m(["Todos","Noticias Locales","Deportes","Cultura","Comunidad"]);noticiasCache=m([]);getCategorias(){return this.categorias}getNoticias(){return this.noticiasCache}getNoticiasPaginadas(a,t,e,r){let c=new h().set("pagina",a.toString()).set("items_por_pagina",t.toString());return e&&e!=="Todos"&&(c=c.set("categoria",e)),r&&r.trim()&&(c=c.set("busqueda",r.trim())),this.http.get(this.baseUrl,{params:c}).pipe(o(i=>({items:i.items.map(u=>s(n({},u),{fecha:new Date(u.fecha),autor:u.autor_nombre})),totalItems:i.total_items,totalPaginas:i.total_paginas,paginaActual:i.pagina_actual,itemsPorPagina:i.items_por_pagina})),f(i=>this.noticiasCache.set(i.items)),g(i=>(console.error("Error al obtener noticias:",i),p({items:[],totalItems:0,totalPaginas:1,paginaActual:1,itemsPorPagina:t}))))}getNoticiaPorId(a){return this.http.get(`${this.baseUrl}/${a}`).pipe(o(t=>s(n({},t),{fecha:new Date(t.fecha),autor:t.autor_nombre})),g(()=>p(void 0)))}agregarNoticia(a){return this.http.post(this.baseUrl,{titulo:a.titulo,descripcion:a.descripcion,contenido:a.contenido,categoria:a.categoria,imagen:a.imagen}).pipe(o(t=>s(n({},t),{fecha:new Date(t.fecha),autor:t.autor_nombre})))}actualizarNoticia(a,t){return this.http.put(`${this.baseUrl}/${a}`,{titulo:t.titulo,descripcion:t.descripcion,contenido:t.contenido,categoria:t.categoria,imagen:t.imagen}).pipe(o(e=>s(n({},e),{fecha:new Date(e.fecha),autor:e.autor_nombre})))}eliminarNoticia(a){return this.http.delete(`${this.baseUrl}/${a}`).pipe(o(()=>!0),g(()=>p(!1)))}buscarNoticias(a){let t=new h().set("busqueda",a);return this.http.get(this.baseUrl,{params:t}).pipe(o(e=>e.items.map(r=>s(n({},r),{fecha:new Date(r.fecha),autor:r.autor_nombre}))),g(()=>p([])))}static \u0275fac=function(t){return new(t||l)};static \u0275prov=d({token:l,factory:l.\u0275fac,providedIn:"root"})};export{C as a};
