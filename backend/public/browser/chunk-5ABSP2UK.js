import{a as I}from"./chunk-EDU4MCBZ.js";import{a as G,b as q,c as B,d as $,e as L,f as R,g as U,h as J,i as W,j as H,k as K}from"./chunk-ZVUM33IL.js";import{c as A,g as V}from"./chunk-B5F5WGXS.js";import"./chunk-QZPEFCOH.js";import{Eb as D,Fa as k,Oa as _,Pa as b,Qa as E,Ra as P,S as v,Sa as O,Ta as x,Ua as t,Va as i,Wa as h,X as p,Y as g,_a as y,ab as m,cb as c,da as u,gb as N,hb as z,ib as j,jb as o,kb as C,lb as M,ob as F,pb as T,qa as w,sa as l}from"./chunk-DCXXYO24.js";var X=(d,n)=>n.id;function Y(d,n){if(d&1&&(t(0,"div",7),o(1),i()),d&2){let e,a,r,s=c();j("success",((e=s.mensaje())==null?null:e.tipo)==="success")("error",((a=s.mensaje())==null?null:a.tipo)==="error"),l(),M(" ",(r=s.mensaje())==null?null:r.texto," ")}}function Z(d,n){if(d&1){let e=y();t(0,"tr")(1,"td"),h(2,"img",8),i(),t(3,"td")(4,"div",9)(5,"span",10),o(6),i(),t(7,"span",11),o(8),i()()(),t(9,"td")(10,"span",12),o(11),i()(),t(12,"td"),o(13),F(14,"date"),i(),t(15,"td")(16,"div",13)(17,"button",14),m("click",function(){let r=p(e).$implicit,s=c();return g(s.openForm(r))}),o(18,"\u270F\uFE0F"),i(),t(19,"button",15),m("click",function(){let r=p(e).$implicit,s=c();return g(s.eliminarNoticia(r.id))}),o(20,"\u{1F5D1}\uFE0F"),i()()()()}if(d&2){let e=n.$implicit,a=c();l(2),x("src",e.imagen,w)("alt",e.titulo),l(4),C(e.titulo),l(2),C(e.descripcion),l(2),z("background-color",a.getCategoriaColor(e.categoria)),l(),M(" ",e.categoria," "),l(2),C(T(14,8,e.fecha,"dd/MM/yyyy"))}}function ee(d,n){if(d&1&&(t(0,"option",41),o(1),i()),d&2){let e=c().$implicit;x("value",e),l(),C(e)}}function te(d,n){if(d&1&&_(0,ee,2,2,"option",41),d&2){let e=n.$implicit;b(e!=="Todos"?0:-1)}}function ie(d,n){d&1&&(t(0,"span",42),o(1,"\u23F3"),i(),o(2," Subiendo imagen... "))}function ne(d,n){d&1&&(t(0,"span",43),o(1,"\u{1F4E4}"),i(),o(2," Subir Mi Imagen "))}function oe(d,n){if(d&1&&(t(0,"div",37),h(1,"img",44),i()),d&2){let e=c(2);l(),x("src",e.imagen(),w)}}function re(d,n){if(d&1){let e=y();t(0,"div",16),m("click",function(){p(e);let r=c();return g(r.closeForm())}),t(1,"div",17),m("click",function(r){return p(e),g(r.stopPropagation())}),t(2,"div",18)(3,"h2",19),o(4),i(),t(5,"button",20),m("click",function(){p(e);let r=c();return g(r.closeForm())}),o(6," \u2715 "),i()(),t(7,"form",21),m("ngSubmit",function(){p(e);let r=c();return g(r.guardarNoticia())}),t(8,"div")(9,"label",22),o(10,"T\xEDtulo *"),i(),t(11,"input",23),m("ngModelChange",function(r){p(e);let s=c();return g(s.titulo.set(r))}),i()(),t(12,"div")(13,"label",22),o(14,"Descripci\xF3n *"),i(),t(15,"textarea",24),m("ngModelChange",function(r){p(e);let s=c();return g(s.descripcion.set(r))}),i()(),t(16,"div")(17,"label",22),o(18,"Contenido"),i(),t(19,"textarea",25),m("ngModelChange",function(r){p(e);let s=c();return g(s.contenido.set(r))}),i()(),t(20,"div")(21,"label",22),o(22,"Categor\xEDa *"),i(),t(23,"select",26),m("ngModelChange",function(r){p(e);let s=c();return g(s.categoria.set(r))}),t(24,"option",27),o(25,"Seleccionar..."),i(),P(26,te,1,1,null,null,E),i()(),t(28,"div")(29,"label",22),o(30,"Imagen de la Noticia"),i(),t(31,"div",28)(32,"input",29,0),m("change",function(r){p(e);let s=c();return g(s.onFileSelected(r))}),i(),t(34,"button",30),m("click",function(){p(e);let r=N(33);return g(r.click())}),_(35,ie,3,0)(36,ne,3,0),i(),t(37,"p",31),o(38," Formatos: PNG, JPG, GIF, WEBP \u2022 Tama\xF1o m\xE1ximo: 5MB "),i()(),t(39,"div",32),h(40,"div",33),t(41,"span",34),o(42,"O"),i(),h(43,"div",33),i(),t(44,"div")(45,"label",35),o(46,"O ingresa una URL:"),i(),t(47,"input",36),m("ngModelChange",function(r){p(e);let s=c();return g(s.imagen.set(r))}),i()()(),_(48,oe,2,1,"div",37),t(49,"div",38)(50,"button",39),m("click",function(){p(e);let r=c();return g(r.closeForm())}),o(51," Cancelar "),i(),t(52,"button",40),o(53),i()()()()()}if(d&2){let e=c();l(4),M(" ",e.editingNoticia()?"Editar Noticia":"Nueva Noticia"," "),l(7),x("ngModel",e.titulo()),l(4),x("ngModel",e.descripcion()),l(4),x("ngModel",e.contenido()),l(4),x("ngModel",e.categoria()),l(3),O(e.categorias()),l(8),x("disabled",e.uploadingImage()),l(),b(e.uploadingImage()?35:36),l(12),x("ngModel",e.imagen()),l(),b(e.imagen()?48:-1),l(4),x("disabled",e.loading()),l(),M(" ",e.loading()?"Guardando...":e.editingNoticia()?"Actualizar":"Crear"," ")}}var Q=class d{authService=v(V);noticiasService=v(I);router=v(A);noticias=u([]);categorias=this.noticiasService.getCategorias();showForm=u(!1);editingNoticia=u(null);loading=u(!1);uploadingImage=u(!1);titulo=u("");descripcion=u("");contenido=u("");categoria=u("");imagen=u("");mensaje=u(null);constructor(){this.authService.isAdmin()||this.router.navigate(["/login"])}ngOnInit(){this.cargarNoticias()}cargarNoticias(){this.loading.set(!0),this.noticiasService.getNoticiasPaginadas(1,100).subscribe({next:n=>{this.noticias.set(n.items),this.loading.set(!1)},error:()=>{this.loading.set(!1),this.mostrarMensaje("error","Error al cargar las noticias")}})}openForm(n){n?(this.editingNoticia.set(n),this.titulo.set(n.titulo),this.descripcion.set(n.descripcion),this.contenido.set(n.contenido),this.categoria.set(n.categoria),this.imagen.set(n.imagen)):this.resetForm(),this.showForm.set(!0)}closeForm(){this.showForm.set(!1),this.resetForm()}resetForm(){this.editingNoticia.set(null),this.titulo.set(""),this.descripcion.set(""),this.contenido.set(""),this.categoria.set(""),this.imagen.set("")}guardarNoticia(){if(!this.titulo()||!this.descripcion()||!this.categoria()){this.mostrarMensaje("error","Por favor completa todos los campos requeridos");return}this.loading.set(!0);let n={titulo:this.titulo(),descripcion:this.descripcion(),contenido:this.contenido()||this.descripcion(),categoria:this.categoria(),imagen:this.imagen()||"https://images.unsplash.com/photo-1504711434969-e33886168f5c?w=400&h=250&fit=crop",fecha:new Date,autor:this.authService.usuario()?.nombre||"Administrador"};this.editingNoticia()?this.noticiasService.actualizarNoticia(this.editingNoticia().id,n).subscribe({next:()=>{this.mostrarMensaje("success","Noticia actualizada correctamente"),this.closeForm(),this.cargarNoticias(),this.loading.set(!1)},error:()=>{this.mostrarMensaje("error","Error al actualizar la noticia"),this.loading.set(!1)}}):this.noticiasService.agregarNoticia(n).subscribe({next:()=>{this.mostrarMensaje("success","Noticia creada correctamente"),this.closeForm(),this.cargarNoticias(),this.loading.set(!1)},error:()=>{this.mostrarMensaje("error","Error al crear la noticia"),this.loading.set(!1)}})}eliminarNoticia(n){confirm("\xBFEst\xE1s seguro de que deseas eliminar esta noticia?")&&(this.loading.set(!0),this.noticiasService.eliminarNoticia(n).subscribe({next:e=>{e?(this.mostrarMensaje("success","Noticia eliminada correctamente"),this.cargarNoticias()):this.mostrarMensaje("error","Error al eliminar la noticia"),this.loading.set(!1)},error:()=>{this.mostrarMensaje("error","Error al eliminar la noticia"),this.loading.set(!1)}}))}mostrarMensaje(n,e){this.mensaje.set({tipo:n,texto:e}),setTimeout(()=>this.mensaje.set(null),3e3)}getCategoriaColor(n){return{"Noticias Locales":"#2563eb",Deportes:"#dc2626",Cultura:"#7c3aed",Comunidad:"#059669"}[n]||"#666"}onFileSelected(n){let e=n.target;if(!e.files||e.files.length===0)return;let a=e.files[0];if(!["image/png","image/jpeg","image/jpg","image/gif","image/webp"].includes(a.type)){this.mostrarMensaje("error","Tipo de archivo no permitido. Solo im\xE1genes PNG, JPG, GIF o WEBP"),e.value="";return}let s=5*1024*1024;if(a.size>s){this.mostrarMensaje("error","La imagen es demasiado grande. M\xE1ximo 5MB"),e.value="";return}this.uploadingImage.set(!0);let S=new FormData;S.append("file",a),fetch("http://localhost:8000/api/upload",{method:"POST",body:S}).then(f=>{if(!f.ok)throw new Error("Error al subir la imagen");return f.json()}).then(f=>{this.imagen.set(f.url),this.mostrarMensaje("success","Imagen subida exitosamente"),this.uploadingImage.set(!1)}).catch(f=>{console.error("Error:",f),this.mostrarMensaje("error","Error al subir la imagen"),this.uploadingImage.set(!1),e.value=""})}static \u0275fac=function(e){return new(e||d)};static \u0275cmp=k({type:d,selectors:[["app-admin"]],decls:28,vars:2,consts:[["fileInput",""],[1,"admin-container"],[1,"admin-header"],[1,"btn-primary",3,"click"],[1,"mensaje",3,"success","error"],[1,"noticias-table"],[2,"position","fixed","top","0","left","0","right","0","bottom","0","background","rgba(0,0,0,0.7)","z-index","9999","display","flex","align-items","center","justify-content","center","padding","20px"],[1,"mensaje"],[1,"table-img",3,"src","alt"],[1,"noticia-info"],[1,"noticia-titulo"],[1,"noticia-desc"],[1,"categoria-badge"],[1,"acciones"],[1,"btn-edit",3,"click"],[1,"btn-delete",3,"click"],[2,"position","fixed","top","0","left","0","right","0","bottom","0","background","rgba(0,0,0,0.7)","z-index","9999","display","flex","align-items","center","justify-content","center","padding","20px",3,"click"],[2,"background","white","border-radius","20px","width","100%","max-width","700px","max-height","90vh","overflow-y","auto","padding","30px","position","relative","z-index","10000","box-shadow","0 20px 60px rgba(0,0,0,0.3)",3,"click"],[2,"display","flex","justify-content","space-between","align-items","center","margin-bottom","20px","padding-bottom","15px","border-bottom","2px solid #ccc"],[2,"margin","0","font-size","24px","color","#333"],["type","button",2,"background","#f44336","color","white","border","none","font-size","24px","width","40px","height","40px","border-radius","8px","cursor","pointer","font-weight","bold",3,"click"],[2,"display","flex","flex-direction","column","gap","20px",3,"ngSubmit"],[2,"display","block","font-weight","bold","margin-bottom","8px","color","#333"],["type","text","name","titulo","placeholder","T\xEDtulo de la noticia","required","",2,"width","100%","padding","12px","border","2px solid #ddd","border-radius","8px","font-size","16px","box-sizing","border-box",3,"ngModelChange","ngModel"],["name","descripcion","placeholder","Descripci\xF3n breve","rows","3","required","",2,"width","100%","padding","12px","border","2px solid #ddd","border-radius","8px","font-size","16px","box-sizing","border-box","resize","vertical",3,"ngModelChange","ngModel"],["name","contenido","placeholder","Contenido completo (opcional)","rows","5",2,"width","100%","padding","12px","border","2px solid #ddd","border-radius","8px","font-size","16px","box-sizing","border-box","resize","vertical",3,"ngModelChange","ngModel"],["name","categoria","required","",2,"width","100%","padding","12px","border","2px solid #ddd","border-radius","8px","font-size","16px","box-sizing","border-box",3,"ngModelChange","ngModel"],["value",""],[2,"margin-bottom","15px"],["type","file","id","fileInput","accept","image/png,image/jpeg,image/jpg,image/gif,image/webp",2,"display","none",3,"change"],["type","button",2,"width","100%","padding","15px","background","linear-gradient(135deg, #667eea 0%, #764ba2 100%)","color","white","border","none","border-radius","8px","font-size","16px","font-weight","bold","cursor","pointer","display","flex","align-items","center","justify-content","center","gap","10px",3,"click","disabled"],[2,"font-size","13px","color","#666","margin-top","8px","text-align","center"],[2,"display","flex","align-items","center","gap","10px","margin","20px 0"],[2,"flex","1","height","1px","background","#ddd"],[2,"color","#999","font-weight","bold","font-size","14px"],[2,"display","block","font-weight","500","margin-bottom","8px","color","#666","font-size","14px"],["type","url","name","imagen","placeholder","https://ejemplo.com/imagen.jpg",2,"width","100%","padding","12px","border","2px solid #ddd","border-radius","8px","font-size","16px","box-sizing","border-box",3,"ngModelChange","ngModel"],[2,"margin-top","10px"],[2,"display","flex","gap","15px","justify-content","flex-end","margin-top","20px","padding-top","20px","border-top","2px solid #ddd"],["type","button",2,"padding","12px 24px","background","#ccc","border","none","border-radius","8px","font-size","16px","cursor","pointer","font-weight","bold",3,"click"],["type","submit",2,"padding","12px 24px","background","#2563eb","color","white","border","none","border-radius","8px","font-size","16px","cursor","pointer","font-weight","bold",3,"disabled"],[3,"value"],[2,"animation","spin 1s linear infinite","display","inline-block"],[2,"font-size","20px"],["alt","Preview",2,"width","100%","max-height","200px","object-fit","cover","border-radius","8px","border","2px solid #ddd",3,"src"]],template:function(e,a){e&1&&(t(0,"div",1)(1,"div",2)(2,"div")(3,"h1"),o(4,"Panel de Administraci\xF3n"),i(),t(5,"p"),o(6,"Gestiona las noticias de la comunidad"),i()(),t(7,"button",3),m("click",function(){return a.openForm()}),o(8," + Nueva Noticia "),i()(),_(9,Y,2,5,"div",4),t(10,"div",5)(11,"table")(12,"thead")(13,"tr")(14,"th"),o(15,"Imagen"),i(),t(16,"th"),o(17,"T\xEDtulo"),i(),t(18,"th"),o(19,"Categor\xEDa"),i(),t(20,"th"),o(21,"Fecha"),i(),t(22,"th"),o(23,"Acciones"),i()()(),t(24,"tbody"),P(25,Z,21,11,"tr",null,X),i()()()(),_(27,re,54,11,"div",6)),e&2&&(l(9),b(a.mensaje()?9:-1),l(16),O(a.noticias()),l(2),b(a.showForm()?27:-1))},dependencies:[K,R,J,W,G,U,q,B,H,L,$,D],styles:[".admin-container[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:2rem 1rem}.admin-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem}.admin-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.75rem;font-weight:700;color:#1a1a1a;margin-bottom:.25rem}.admin-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#666;font-size:.9rem}.btn-primary[_ngcontent-%COMP%]{background:#2563eb;color:#fff;padding:.75rem 1.25rem;border:none;border-radius:8px;font-size:.9rem;font-weight:600;cursor:pointer;transition:background-color .2s}.btn-primary[_ngcontent-%COMP%]:hover{background:#1d4ed8}.btn-secondary[_ngcontent-%COMP%]{background:#f3f4f6;color:#333;padding:.75rem 1.25rem;border:none;border-radius:8px;font-size:.9rem;font-weight:600;cursor:pointer;transition:background-color .2s}.btn-secondary[_ngcontent-%COMP%]:hover{background:#e5e7eb}.mensaje[_ngcontent-%COMP%]{padding:1rem;border-radius:8px;margin-bottom:1rem;font-size:.9rem}.mensaje.success[_ngcontent-%COMP%]{background:#d1fae5;color:#065f46}.mensaje.error[_ngcontent-%COMP%]{background:#fee2e2;color:#dc2626}.noticias-table[_ngcontent-%COMP%]{background:#fff;border-radius:12px;box-shadow:0 2px 8px #00000014;overflow:hidden}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:1rem;text-align:left;border-bottom:1px solid #e5e7eb}th[_ngcontent-%COMP%]{background:#f9fafb;font-weight:600;color:#374151;font-size:.8rem;text-transform:uppercase;letter-spacing:.5px}.table-img[_ngcontent-%COMP%]{width:80px;height:50px;object-fit:cover;border-radius:6px}.noticia-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.noticia-titulo[_ngcontent-%COMP%]{font-weight:600;color:#1a1a1a;font-size:.9rem}.noticia-desc[_ngcontent-%COMP%]{color:#666;font-size:.8rem;display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;line-clamp:1;overflow:hidden}.categoria-badge[_ngcontent-%COMP%]{display:inline-block;padding:.25rem .75rem;border-radius:12px;color:#fff;font-size:.75rem;font-weight:600}.acciones[_ngcontent-%COMP%]{display:flex;gap:.5rem}.btn-edit[_ngcontent-%COMP%], .btn-delete[_ngcontent-%COMP%]{background:none;border:none;font-size:1.1rem;cursor:pointer;padding:.5rem;border-radius:6px;transition:background-color .2s}.btn-edit[_ngcontent-%COMP%]:hover{background:#f3f4f6}.btn-delete[_ngcontent-%COMP%]:hover{background:#fee2e2}.modal-overlay[_ngcontent-%COMP%]{position:fixed!important;inset:0!important;background:#00000080!important;display:flex!important;align-items:center!important;justify-content:center!important;z-index:9999!important;padding:1rem!important}.modal[_ngcontent-%COMP%]{background:#fff!important;border-radius:16px!important;width:100%!important;max-width:600px!important;max-height:90vh!important;overflow-y:auto!important;position:relative!important;z-index:10000!important;box-shadow:0 10px 40px #0000004d!important}.modal-header[_ngcontent-%COMP%]{display:flex!important;justify-content:space-between!important;align-items:center!important;padding:1.5rem!important;border-bottom:1px solid #e5e7eb!important}.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.25rem!important;font-weight:700!important;color:#1a1a1a!important;margin:0!important}.close-btn[_ngcontent-%COMP%]{background:none!important;border:none!important;font-size:1.5rem!important;cursor:pointer!important;color:#666!important;padding:.5rem!important;border-radius:6px!important;line-height:1!important}.close-btn[_ngcontent-%COMP%]:hover{background:#f3f4f6!important}.modal-form[_ngcontent-%COMP%]{padding:1.5rem!important;display:flex!important;flex-direction:column!important;gap:1.25rem!important}.form-group[_ngcontent-%COMP%]{display:flex!important;flex-direction:column!important;gap:.5rem!important}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.875rem!important;font-weight:500!important;color:#333!important}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:.75rem 1rem!important;border:1px solid #e5e7eb!important;border-radius:8px!important;font-size:1rem!important;font-family:inherit!important;width:100%!important}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none!important;border-color:#2563eb!important;box-shadow:0 0 0 3px #2563eb1a!important}.form-row[_ngcontent-%COMP%]{display:grid!important;grid-template-columns:repeat(2,1fr)!important;gap:1rem!important}.image-preview[_ngcontent-%COMP%]{border-radius:8px!important;overflow:hidden!important;margin-top:.5rem!important}.image-preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%!important;height:150px!important;object-fit:cover!important;display:block!important}.modal-actions[_ngcontent-%COMP%]{display:flex!important;justify-content:flex-end!important;gap:1rem!important;padding-top:1rem!important;border-top:1px solid #e5e7eb!important;margin-top:.5rem!important}@media (max-width: 768px){.admin-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:1rem}.noticias-table[_ngcontent-%COMP%]{overflow-x:auto}table[_ngcontent-%COMP%]{min-width:600px}.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}.modal[_ngcontent-%COMP%]{max-height:95vh;border-radius:20px 20px 0 0}.modal-header[_ngcontent-%COMP%]{padding:1.5rem}.modal-icon[_ngcontent-%COMP%]{width:3rem;height:3rem;font-size:1.5rem}.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.25rem}.modal-form[_ngcontent-%COMP%]{padding:1.5rem}.suggestion-links[_ngcontent-%COMP%]{flex-direction:column}.suggestion-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-align:center}}"]})};export{Q as Admin};
