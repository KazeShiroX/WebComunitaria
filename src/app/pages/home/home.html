<div class="home-wrapper">
  <!-- Dreamy Sky Pink Glow -->
  <div class="dreamy-background"></div>

  <div class="home-container">
    <section class="hero">
      <h1>Noticias de Juan José Ríos</h1>
      <p>Mantente al día con las últimas noticias y acontecimientos de nuestra comunidad.</p>
    </section>

    <section class="search-section">
      <div class="search-box">
        <span class="search-icon"><i class="bi bi-search"></i></span>
        <input type="text" placeholder="Buscar noticias..." [value]="terminoBusqueda()" (input)="buscar($event)" />
      </div>
    </section>

    <section class="categorias">
      @for (categoria of categorias(); track categoria) {
      <button class="categoria-btn" [class.active]="categoriaActiva() === categoria"
        (click)="filtrarPorCategoria(categoria)">
        {{ categoria }}
      </button>
      }
    </section>

    <section class="noticias-grid">
      @for (noticia of noticiasPaginadas().items; track noticia.id) {
      <article class="noticia-card" (click)="verNoticia(noticia)" style="cursor: pointer;">
        <img [src]="noticia.imagen" [alt]="noticia.titulo" class="noticia-imagen" />
        <div class="noticia-content">
          <span class="noticia-categoria" [style.color]="getCategoriaColor(noticia.categoria)">
            {{ noticia.categoria }}
          </span>
          <h3 class="noticia-titulo">{{ noticia.titulo }}</h3>
          <p class="noticia-descripcion">{{ noticia.descripcion }}</p>
        </div>
      </article>
      }
    </section>

    @if (noticiasPaginadas().totalPaginas > 1) {
    <section class="paginacion">
      <button class="pag-btn" [disabled]="paginaActual() === 1" (click)="irAPagina(paginaActual() - 1)">
        ‹
      </button>

      @for (pagina of getPaginas(); track pagina) {
      @if (pagina === '...') {
      <span class="pag-ellipsis">...</span>
      } @else {
      <button class="pag-btn" [class.active]="paginaActual() === pagina" (click)="irAPagina(+pagina)">
        {{ pagina }}
      </button>
      }
      }

      <button class="pag-btn" [disabled]="paginaActual() === noticiasPaginadas().totalPaginas"
        (click)="irAPagina(paginaActual() + 1)">
        ›
      </button>
    </section>
    }
  </div>
</div>

<!-- MODAL DE DETALLE -->
@if (showModal() && noticiaSeleccionada()) {
<div
  style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.8); z-index: 9999; display: flex; align-items: center; justify-content: center; padding: 20px; overflow-y: auto;"
  (click)="cerrarModal()">

  <div (click)="$event.stopPropagation()"
    style="background: white; border-radius: 20px; width: 100%; max-width: 900px; max-height: 90vh; overflow-y: auto; position: relative;">

    <!-- Imagen de portada -->
    <div style="position: relative; width: 100%; height: 400px; overflow: hidden; border-radius: 20px 20px 0 0;">
      <img [src]="noticiaSeleccionada()!.imagen" [alt]="noticiaSeleccionada()!.titulo"
        style="width: 100%; height: 100%; object-fit: cover;">

      <!-- Botón cerrar -->
      <button (click)="cerrarModal()" type="button"
        style="position: absolute; top: 20px; right: 20px; background: rgba(255,255,255,0.95); border: none; width: 45px; height: 45px; border-radius: 50%; font-size: 24px; cursor: pointer; box-shadow: 0 4px 12px rgba(0,0,0,0.3); font-weight: bold; color: #333; display: flex; align-items: center; justify-content: center;">
        ✕
      </button>

      <!-- Categoría badge -->
      <div style="position: absolute; bottom: 20px; left: 30px;">
        <span [style.background-color]="getCategoriaColor(noticiaSeleccionada()!.categoria)"
          style="padding: 10px 20px; border-radius: 25px; color: white; font-weight: bold; font-size: 14px; box-shadow: 0 4px 12px rgba(0,0,0,0.2);">
          {{ noticiaSeleccionada()!.categoria }}
        </span>
      </div>
    </div>

    <!-- Contenido -->
    <div style="padding: 40px;">
      <!-- Título -->
      <h1 style="font-size: 36px; font-weight: 800; color: #1a1a1a; margin: 0 0 20px 0; line-height: 1.2;">
        {{ noticiaSeleccionada()!.titulo }}
      </h1>

      <!-- Meta información -->
      <div
        style="display: flex; align-items: center; gap: 20px; margin-bottom: 30px; padding-bottom: 20px; border-bottom: 2px solid #f0f0f0;">
        <div style="display: flex; align-items: center; gap: 8px; color: #666;">
          <span style="font-size: 20px;"><i class="bi bi-calendar"></i></span>
          <span style="font-size: 14px; font-weight: 500;">{{ noticiaSeleccionada()!.fecha | date:'dd/MM/yyyy' }}</span>
        </div>
        <div style="display: flex; align-items: center; gap: 8px; color: #666;">
          <span style="font-size: 20px;"><i class="bi bi-person"></i></span>
          <span style="font-size: 14px; font-weight: 500;">{{ noticiaSeleccionada()!.autor }}</span>
        </div>
      </div>

      <!-- Descripción -->
      <div
        style="background: #f8f9fa; padding: 20px; border-left: 4px solid #2563eb; border-radius: 8px; margin-bottom: 30px;">
        <p style="font-size: 18px; font-weight: 500; color: #374151; margin: 0; line-height: 1.6;">
          {{ noticiaSeleccionada()!.descripcion }}
        </p>
      </div>

      <!-- Contenido completo -->
      @if (noticiaSeleccionada()!.contenido) {
      <div style="font-size: 17px; line-height: 1.8; color: #333; white-space: pre-wrap;">
        {{ noticiaSeleccionada()!.contenido }}
      </div>
      }
    </div>

  </div>

</div>
}